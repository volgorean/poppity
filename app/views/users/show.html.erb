<h1 class="section-title"><%= @user.username %></h1>

<% if current_user%>
    <div class="flexi-i listing">
      <ul class="rows">
        <%= form_tag(create_trade_path, method: "POST") do %>
          <input type="hidden" name="user_id" value="<%= @user.id %>"></input>
          <input type="submit" class="new-trade-button" value="Open new trade with <%= @user.username %>"></input>
        <% end %>

        <% @trades.each do |trade| %>
          <li class="flexi-c r">
            <%= link_to trade.status, trade_path(trade), class: "flexi-i" %>
            <%= link_to "created #{time_ago_in_words(trade.created_at)}", trade_path(trade), class: "flexi-i" %>
          </li>
        <% end %>
      </ul>
    </div>
<% end %>

<h1 class="section-title">Wish List</h1>

<% @user.wish_items.group_by(&:collection).each do |collection, badges| %>
  <h3 class="year-title"><%= collection.name %></h3>

  <div class="cards six">
    <% badges.each do |b| %>
      <div class="card card-gold">
        <%= link_to "", badge_path(b), class: "card-image", style: "background: url(#{b.image.url}) no-repeat center; background-size: contain;" %>
        <%= link_to b.name, badge_path(b), class: "card-title" %>
      </div>
    <% end %>
  </div>
<% end %>

<h1 class="section-title">Owns</h1>

<% @user.badges.preload(:inventories).group_by(&:collection).each do |collection, badges| %>
  <h3 class="year-title"><%= collection.name %></h3>

  <div class="cards six">
    <% badges.each do |b| %>
      <div class="card">
        <p class="card-inventory"><%= b.inventories.find_by(user_id: @user.id).number %></p>

        <%= link_to "", badge_path(b), class: "card-image", style: "background: url(#{b.image.url}) no-repeat center; background-size: contain;" %>
        <%= link_to b.name, badge_path(b), class: "card-title" %>
      </div>
    <% end %>
  </div>
<% end %>
